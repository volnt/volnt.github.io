<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Emacs configuration</title>
<meta name="generator" content="Org mode" />
<link rel="stylesheet" href="/css/org.css" /> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/brands.min.css">
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="/notes/"> UP </a>
 |
 <a accesskey="H" href="/"> HOME </a>
</div><div id="content">
<h1 class="title">Emacs configuration</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org7701c3c">Emacs configuration</a>
<ul>
<li><a href="#org23af662">Boostrap straight.el</a></li>
<li><a href="#org2394b6b">Custom file location</a></li>
<li><a href="#org15a1e59">Update defaults</a></li>
<li><a href="#org6d59944">Org-mode</a></li>
<li><a href="#org432ed17">Install major modes</a></li>
<li><a href="#org7e07c4a">Theme</a></li>
<li><a href="#orgd95c04d">UI</a></li>
<li><a href="#orgd8c651b">Utilities</a>
<ul>
<li><a href="#org298c393">Vterm</a></li>
</ul>
</li>
<li><a href="#orgbc6e22c">Python setup</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org7701c3c" class="outline-2">
<h2 id="org7701c3c">Emacs configuration</h2>
<div class="outline-text-2" id="text-org7701c3c">
<p>
Source for my Emacs configuration. The init.el file can be generated from this org file using <code>org-babel-tangle</code> (<a href="https://orgmode.org/worg/org-contrib/babel/intro.html#literate-programming-example">reference</a>).
</p>
</div>

<div id="outline-container-org23af662" class="outline-3">
<h3 id="org23af662">Boostrap straight.el</h3>
<div class="outline-text-3" id="text-org23af662">
<p>
Use <a href="https://github.com/raxod502/straight.el">straight.el</a> with the <code>use-package</code> form to install and manage emacs packages.
</p>

<div class="org-src-container">
<pre class="src src-elisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">Disable emacs default package.el (in favor of straight.el)</span>
(<span class="org-keyword">setq</span> package-enable-at-startup nil)

<span class="org-comment-delimiter">;; </span><span class="org-comment">Bootstrap straight.el</span>
(<span class="org-keyword">defvar</span> <span class="org-variable-name">bootstrap-version</span>)
(<span class="org-keyword">let</span> ((bootstrap-file
       (expand-file-name <span class="org-string">"straight/repos/straight.el/bootstrap.el"</span> user-emacs-directory))
      (bootstrap-version 5))
  (<span class="org-keyword">unless</span> (file-exists-p bootstrap-file)
    (<span class="org-keyword">with-current-buffer</span>
        (url-retrieve-synchronously
         <span class="org-string">"https://raw.githubusercontent.com/raxod502/straight.el/develop/install.el"</span>
         'silent 'inhibit-cookies)
      (goto-char (point-max))
      (eval-print-last-sexp)))
  (load bootstrap-file nil 'nomessage))

(straight-use-package 'use-package) <span class="org-comment-delimiter">;; </span><span class="org-comment">Use the use-package form to install define packages</span>

(use-package straight
  <span class="org-builtin">:custom</span> (straight-use-package-by-default t)) <span class="org-comment-delimiter">;; </span><span class="org-comment">Make :straight t the default to ensure packages are installed</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org2394b6b" class="outline-3">
<h3 id="org2394b6b">Custom file location</h3>
<div class="outline-text-3" id="text-org2394b6b">
<p>
Set the custom file location.
</p>

<div class="org-src-container">
<pre class="src src-elisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">Set custom file location</span>
(<span class="org-keyword">setq</span> custom-file <span class="org-string">"~/.emacs.d/custom.el"</span>)
(load custom-file)
</pre>
</div>
</div>
</div>

<div id="outline-container-org15a1e59" class="outline-3">
<h3 id="org15a1e59">Update defaults</h3>
<div class="outline-text-3" id="text-org15a1e59">
<p>
Update a few defaults like the menu-bar, scroll-bar etc.
</p>
<div class="org-src-container">
<pre class="src src-elisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">Remove menu, scroll bars and other visual things</span>
(menu-bar-mode -1)
(scroll-bar-mode -1)
(tool-bar-mode -1)
(<span class="org-keyword">setq</span> column-number-mode nil)
(<span class="org-keyword">setq</span> line-number-mode nil)
(<span class="org-keyword">setq</span> size-indication-mode nil)
(<span class="org-keyword">setq</span> inhibit-startup-screen t)
(<span class="org-keyword">setq</span> mouse-yank-at-point t)
(<span class="org-keyword">setq-default</span> indent-tabs-mode nil)

(global-display-line-numbers-mode t)

<span class="org-comment-delimiter">;; </span><span class="org-comment">Disable line numbers for some modes</span>
(<span class="org-keyword">dolist</span> (mode '(org-mode-hook
                term-mode-hook
                shell-mode-hook
                treemacs-mode-hook
                eshell-mode-hook))
  (add-hook mode (<span class="org-keyword">lambda</span> () (display-line-numbers-mode 0))))

(add-hook 'before-save-hook 'delete-trailing-whitespace)
</pre>
</div>
</div>
</div>

<div id="outline-container-org6d59944" class="outline-3">
<h3 id="org6d59944">Org-mode</h3>
<div class="outline-text-3" id="text-org6d59944">
<p>
I use org-mode to organize my tasks, edit this website and write meeting notes and keep some long-term documentation.
</p>

<p>
I have a few different files for tasks and I like to clean them up by removing old DONE tasks. My exact workflow is that I have a recurrent tasks every two weeks that reminds me to refile DONE tasks older than two weeks to an <code>archive.org</code> file.
</p>

<p>
To automate this, a few custom functions are needed to find DONE tasks older than two weeks. (source: <a href="https://stackoverflow.com/a/8186450">https://stackoverflow.com/a/8186450</a>)
</p>


<div class="org-src-container">
<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">zin/since-state</span> (since todo-state <span class="org-type">&amp;optional</span> done all)
  <span class="org-doc">"List Agenda items that are older than SINCE.</span>

<span class="org-doc">TODO-STATE is a regexp for matching to TODO states.  It is provided to</span>
<span class="org-doc">`</span><span class="org-doc"><span class="org-constant">zin/find-state</span></span><span class="org-doc">' to match inactive timestamps.</span>
<span class="org-doc">SINCE is compared to the result of `</span><span class="org-doc"><span class="org-constant">zin/org-date-diff</span></span><span class="org-doc">'.  If</span>
<span class="org-doc">`</span><span class="org-doc"><span class="org-constant">zin/org-date-diff</span></span><span class="org-doc">' is greater than SINCE, the entry is shown in the</span>
<span class="org-doc">Agenda.</span>
<span class="org-doc">Optional argument DONE allows for done and not-done headlines to be</span>
<span class="org-doc">evaluated.  If DONE is non-nil, match completed tasks.</span>
<span class="org-doc">Optional argument ALL is passed to `</span><span class="org-doc"><span class="org-constant">zin/find-state</span></span><span class="org-doc">' to specify whether</span>
<span class="org-doc">to search for any possible match of STATE, or only in the most recent</span>
<span class="org-doc">log entry."</span>
  (<span class="org-keyword">let</span> ((next-headline (<span class="org-keyword">save-excursion</span> (<span class="org-keyword">or</span> (outline-next-heading) (point-max)))))
    <span class="org-comment-delimiter">;; </span><span class="org-comment">If DONE is non-nil, look for done keywords, if nil look for not-done</span>
    (<span class="org-keyword">if</span> (member (org-get-todo-state)
                (<span class="org-keyword">if</span> done
                    org-done-keywords
                  org-not-done-keywords))
        (<span class="org-keyword">let*</span> ((subtree-end (<span class="org-keyword">save-excursion</span> (org-end-of-subtree t)))
               (subtree-valid (<span class="org-keyword">save-excursion</span>
                               (forward-line 1)
                               (<span class="org-keyword">if</span> (<span class="org-keyword">and</span> (&lt; (point) subtree-end)
                                        <span class="org-comment-delimiter">;; </span><span class="org-comment">Find the timestamp to test</span>
                                        (zin/find-state todo-state subtree-end all))
                                   (<span class="org-keyword">let</span> ((startpoint (point)))
                                     (forward-word 3)
                                     <span class="org-comment-delimiter">;; </span><span class="org-comment">Convert timestamp into days difference from today</span>
                                     (zin/org-date-diff startpoint (point)))))))
          (<span class="org-keyword">if</span> (<span class="org-keyword">or</span> (not subtree-valid)
                  (&lt;= subtree-valid since))
              next-headline
            nil))
      (<span class="org-keyword">or</span> next-headline (point-max)))))

(<span class="org-keyword">defun</span> <span class="org-function-name">zin/find-state</span> (state <span class="org-type">&amp;optional</span> end all)
  <span class="org-doc">"Used to search through the logbook of subtrees.</span>

<span class="org-doc">Tests to see if the first line of the logbook is a change of todo</span>
<span class="org-doc">status to status STATE</span>
<span class="org-doc">- Status \"STATE\" from ...</span>
<span class="org-doc">The search brings the point to the start of YYYY-MM-DD in inactive timestamps.</span>

<span class="org-doc">Optional argument END defines the point at which to stop searching.</span>
<span class="org-doc">Optional argument ALL when non-nil specifies to look for any occurence</span>
<span class="org-doc">of STATE in the subtree, not just in the most recent entry."</span>
  (<span class="org-keyword">let</span> ((drawer (<span class="org-keyword">if</span> all <span class="org-string">""</span> <span class="org-string">":.*:\\W"</span> <span class="org-string">"CLOSED:"</span>)))
    (<span class="org-keyword">or</span> (re-search-forward (concat drawer <span class="org-string">".*State \\\""</span> state <span class="org-string">"\\\"\\W+from.*\\["</span>) end t)
        (re-search-forward (concat drawer <span class="org-string">".*\\["</span>) end t))))

(<span class="org-keyword">defun</span> <span class="org-function-name">zin/org-date-diff</span> (start end <span class="org-type">&amp;optional</span> compare)
  <span class="org-doc">"Calculate difference between  selected timestamp to current date.</span>

<span class="org-doc">The difference between the dates is calculated in days.</span>
<span class="org-doc">START and END define the region within which the timestamp is found.</span>
<span class="org-doc">Optional argument COMPARE allows for comparison to a specific date rather than to current date."</span>
  (<span class="org-keyword">let*</span> ((start-date (<span class="org-keyword">if</span> compare compare (calendar-current-date))))
    (- (calendar-absolute-from-gregorian start-date) (org-time-string-to-absolute (buffer-substring-no-properties start end)))
    ))
</pre>
</div>

<p>
In the org-mode configuration you can see references to files that are not part of this repository. The <code>org-agenda-files</code> and the <code>org-capture-templates</code> templates.
</p>

<p>
I use capture templates to create new notes / recipes on this website. Each page is a different org file and for recipes there's a common template.
</p>

<p>
There's also the <code>org-agenda-custom-commands</code> that uses the previously defined functions to refiles old DONE tasks.
</p>

<div class="org-src-container">
<pre class="src src-elisp">(use-package org
  <span class="org-builtin">:bind</span> ((<span class="org-string">"C-c a"</span> . org-agenda-list)
         (<span class="org-string">"C-c l"</span> . org-store-link)
         (<span class="org-string">"C-c c"</span> . org-capture))
  <span class="org-builtin">:hook</span>
  (org-mode . org-indent-mode)
  (org-mode . visual-line-mode)
  <span class="org-builtin">:config</span>
  (<span class="org-keyword">setq</span> org-html-doctype <span class="org-string">"html5"</span> <span class="org-comment-delimiter">;; </span><span class="org-comment">HTML export</span>

        <span class="org-comment-delimiter">;; </span><span class="org-comment">Visual tweaks</span>
        org-hide-emphasis-markers t
        org-ellipsis <span class="org-string">" &#9660; "</span>

        <span class="org-comment-delimiter">;; </span><span class="org-comment">Startup</span>
        org-startup-with-inline-images t
        org-startup-folded <span class="org-string">"showeverything"</span>
        org-startup-indented t

        <span class="org-comment-delimiter">;; </span><span class="org-comment">Babel</span>
        org-babel-min-lines-for-block-output 1
        org-confirm-babel-evaluate nil
        org-src-preserve-indentation t

        <span class="org-comment-delimiter">;; </span><span class="org-comment">Fontify</span>
        org-fontify-done-headline t
        org-src-fontify-natively t

        <span class="org-comment-delimiter">;; </span><span class="org-comment">Agenda</span>
        org-agenda-start-with-log-mode t
        org-log-done 'time
        org-agenda-skip-scheduled-if-done t
        org-log-into-drawer t
        org-agenda-files '(<span class="org-string">"~/org/work.org"</span> <span class="org-string">"~/org/keep.org"</span> <span class="org-string">"~/org/house.org"</span> <span class="org-string">"~/org/perso.org"</span>)

        org-agenda-custom-commands '((<span class="org-string">"R"</span> <span class="org-string">"Tasks that were completed more than 14 days ago."</span> tags <span class="org-string">"-REFILE/"</span>
               ((org-agenda-files '(<span class="org-string">"~/org/work.org"</span> <span class="org-string">"~/org/perso.org"</span> <span class="org-string">"~/org/house.org"</span>))
                (org-agenda-overriding-header <span class="org-string">"Archivable tasks"</span>)
                (org-agenda-skip-function '(zin/since-state 14 <span class="org-string">"\</span><span class="org-string"><span class="org-regexp-grouping-backslash">\</span></span><span class="org-string"><span class="org-warning"><span class="org-regexp-grouping-backslash">\</span></span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">DONE\</span><span class="org-string"><span class="org-regexp-grouping-backslash">\</span></span><span class="org-string"><span class="org-warning"><span class="org-regexp-grouping-backslash">\</span></span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">CANC\</span><span class="org-string"><span class="org-regexp-grouping-backslash">\</span></span><span class="org-string"><span class="org-warning"><span class="org-regexp-grouping-backslash">\</span></span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">"</span> t)))))



        <span class="org-comment-delimiter">;; </span><span class="org-comment">Refiling</span>
        org-refile-targets '((<span class="org-string">"~/org/archives.org"</span> <span class="org-builtin">:maxlevel</span> . 1)))

  (advice-add 'org-refile <span class="org-builtin">:after</span> 'org-save-all-org-buffers)

  (<span class="org-keyword">setq</span> org-todo-keywords
        '((sequence <span class="org-string">"TODO(t!)"</span> <span class="org-string">"|"</span> <span class="org-string">"DONE(d!)"</span>)))

  (<span class="org-keyword">setq</span> org-capture-templates
        '((<span class="org-string">"s"</span> <span class="org-string">"Site Entries"</span>)
          (<span class="org-string">"sr"</span> <span class="org-string">"Recipe"</span> plain
           (file (<span class="org-keyword">lambda</span> () (expand-file-name (read-string <span class="org-string">"Filename: "</span>) <span class="org-string">"~/dev/volnt.github.io/recipes/"</span>)))
           (file <span class="org-string">"~/org/templates/recipe.org"</span>))
          (<span class="org-string">"sn"</span> <span class="org-string">"Note"</span> plain
           (file (<span class="org-keyword">lambda</span> () (expand-file-name (read-string <span class="org-string">"Filename: "</span>) <span class="org-string">"~/dev/volnt.github.io/notes/"</span>))))
          (<span class="org-string">"t"</span> <span class="org-string">"Todo Entries"</span>)
          (<span class="org-string">"tt"</span> <span class="org-string">"Todo"</span> entry (file <span class="org-string">"~/org/perso.org"</span>)
           <span class="org-string">"* TODO %?\n%U\n%i"</span> <span class="org-builtin">:empty-lines</span> 1)
          (<span class="org-string">"th"</span> <span class="org-string">"House entry."</span> entry (file <span class="org-string">"~/org/house.org"</span>)
           <span class="org-string">"* TODO %? :house:\n%U\n%i"</span> <span class="org-builtin">:empty-lines</span> 1)
          (<span class="org-string">"tw"</span> <span class="org-string">"Work entry."</span> entry (file <span class="org-string">"~/org/work.org"</span>)
           <span class="org-string">"* TODO %? :work:\n%U\n%i"</span> <span class="org-builtin">:empty-lines</span> 1)
          (<span class="org-string">"m"</span> <span class="org-string">"Meeting Entries"</span>)
          (<span class="org-string">"mm"</span> <span class="org-string">"Meeting"</span> entry (file <span class="org-string">"~/org/perso.org"</span>)
           <span class="org-string">"* %? :meeting:\n%U\n%i"</span> <span class="org-builtin">:clock-in</span> <span class="org-builtin">:clock-resume</span> <span class="org-builtin">:empty-lines</span> 1)
          (<span class="org-string">"mw"</span> <span class="org-string">"Work Meeting"</span> entry (file <span class="org-string">"~/org/work.org"</span>)
           <span class="org-string">"* %? :work:meeting:\n%U\n%i"</span> <span class="org-builtin">:clock-in</span> <span class="org-builtin">:clock-resume</span> <span class="org-builtin">:empty-lines</span> 1)
          (<span class="org-string">"mo"</span> <span class="org-string">"One-to-One"</span> entry (file+headline <span class="org-string">"~/org/work.org"</span> <span class="org-string">"One-to-one"</span>)
           <span class="org-string">"* TODO %? :work:meeting:\n%U\n%i"</span> <span class="org-builtin">:clock-in</span> <span class="org-builtin">:clock-resume</span> <span class="org-builtin">:empty-lines</span> 1)
          (<span class="org-string">"mt"</span> <span class="org-string">"Tech Screening"</span> entry (file <span class="org-string">"~/org/work.org"</span>)
           (file <span class="org-string">"~/org/templates/tech-screening.org"</span>) <span class="org-builtin">:clock-in</span> <span class="org-builtin">:clock-resume</span> <span class="org-builtin">:empty-lines</span> 1)
          (<span class="org-string">"ml"</span> <span class="org-string">"ML Interview"</span> entry (file <span class="org-string">"~/org/work.org"</span>)
           (file <span class="org-string">"~/org/templates/ml-engineer-screening.org"</span>) <span class="org-builtin">:clock-in</span> <span class="org-builtin">:clock-resume</span> <span class="org-builtin">:empty-lines</span> 1)))

  (org-babel-do-load-languages
   'org-babel-load-languages '((python . t) (shell . t) (C . t) (gnuplot . t)))
  (use-package org-superstar
    <span class="org-builtin">:hook</span> (org-mode . org-superstar-mode)
    <span class="org-builtin">:custom</span>
    (org-superstar-remove-leading-stars t)
    (org-superstar-headline-bullets-list '(<span class="org-string">"&#9673;"</span> <span class="org-string">"&#9675;"</span> <span class="org-string">"&#9679;"</span> <span class="org-string">"&#9675;"</span> <span class="org-string">"&#9679;"</span> <span class="org-string">"&#9675;"</span> <span class="org-string">"&#9679;"</span>)))
  (use-package epresent)
  (use-package ox-jira)
  (straight-use-package '(org-contrib <span class="org-builtin">:includes</span> org-checklist))
  (load <span class="org-string">"org-checklist"</span>))
</pre>
</div>
</div>
</div>

<div id="outline-container-org432ed17" class="outline-3">
<h3 id="org432ed17">Install major modes</h3>
<div class="outline-text-3" id="text-org432ed17">
<p>
A few major modes I use.
</p>

<div class="org-src-container">
<pre class="src src-elisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">Major modes</span>

(use-package ledger-mode)
(use-package gnuplot
  <span class="org-builtin">:config</span>
  (use-package gnuplot-mode))
(use-package lua-mode)
(use-package typescript-mode)
(use-package yaml-mode)
(use-package terraform-mode)
(use-package markdown-mode)
</pre>
</div>
</div>
</div>

<div id="outline-container-org7e07c4a" class="outline-3">
<h3 id="org7e07c4a">Theme</h3>
<div class="outline-text-3" id="text-org7e07c4a">
<p>
Setup the theme (color-theme + modeline).
</p>

<div class="org-src-container">
<pre class="src src-elisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">Theme</span>

(use-package solarized-theme
  <span class="org-builtin">:config</span> (load-theme 'solarized-selenized-dark))

(use-package doom-modeline
  <span class="org-builtin">:init</span> (doom-modeline-mode 1)
  <span class="org-builtin">:config</span>
  (use-package all-the-icons)) <span class="org-comment-delimiter">;; </span><span class="org-comment">eval-expression (all-the-icons-install-fonts) on first run</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd95c04d" class="outline-3">
<h3 id="orgd95c04d">UI</h3>
<div class="outline-text-3" id="text-orgd95c04d">
<p>
All UI related packages.
</p>

<p>
Use <code>vertico</code> for minibuffer completion with <code>marginalia</code> for added details.
</p>

<p>
For code-completion use <code>company</code>.
</p>

<div class="org-src-container">
<pre class="src src-elisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">UI</span>

(use-package unicode-fonts
  <span class="org-builtin">:config</span>
  (unicode-fonts-setup)
  (use-package font-utils)
  (use-package ucs-utils))

(use-package flycheck
  <span class="org-builtin">:config</span> (global-flycheck-mode))

(use-package vertico
  <span class="org-builtin">:init</span>
  (vertico-mode)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Different scroll margin</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq vertico-scroll-margin 0)</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Show more candidates</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq vertico-count 20)</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Grow and shrink the Vertico minibuffer</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq vertico-resize t)</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Optionally enable cycling for `</span><span class="org-comment"><span class="org-constant">vertico-next</span></span><span class="org-comment">' and `</span><span class="org-comment"><span class="org-constant">vertico-previous</span></span><span class="org-comment">'.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq vertico-cycle t)</span>
  )

<span class="org-comment-delimiter">;; </span><span class="org-comment">Optionally use the `</span><span class="org-comment"><span class="org-constant">orderless</span></span><span class="org-comment">' completion style. See</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">+orderless-dispatch</span></span><span class="org-comment">' in the Consult wiki for an advanced Orderless style</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">dispatcher. Additionally enable `</span><span class="org-comment"><span class="org-constant">partial-completion</span></span><span class="org-comment">' for file path</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">expansion. `</span><span class="org-comment"><span class="org-constant">partial-completion</span></span><span class="org-comment">' is important for wildcard support.</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Multiple files can be opened at once with `</span><span class="org-comment"><span class="org-constant">find-file</span></span><span class="org-comment">' if you enter a</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">wildcard. You may also give the `</span><span class="org-comment"><span class="org-constant">initials</span></span><span class="org-comment">' completion style a try.</span>
(use-package orderless
  <span class="org-builtin">:init</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Configure a custom style dispatcher (see the Consult wiki)</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq orderless-style-dispatchers '(+orderless-dispatch)</span>
  <span class="org-comment-delimiter">;;       </span><span class="org-comment">orderless-component-separator #'orderless-escapable-split-on-space)</span>
  (<span class="org-keyword">setq</span> completion-styles '(orderless)
        completion-category-defaults nil
        completion-category-overrides '((file (styles partial-completion)))))

<span class="org-comment-delimiter">;; </span><span class="org-comment">Persist history over Emacs restarts. Vertico sorts by history position.</span>
(use-package savehist
  <span class="org-builtin">:init</span>
  (savehist-mode))

<span class="org-comment-delimiter">;; </span><span class="org-comment">A few more useful configurations...</span>
(use-package emacs
  <span class="org-builtin">:init</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Add prompt indicator to `</span><span class="org-comment"><span class="org-constant">completing-read-multiple</span></span><span class="org-comment">'.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Alternatively try `</span><span class="org-comment"><span class="org-constant">consult-completing-read-multiple</span></span><span class="org-comment">'.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">crm-indicator</span> (args)
    (cons (concat <span class="org-string">"[CRM] "</span> (car args)) (cdr args)))
  (advice-add #'completing-read-multiple <span class="org-builtin">:filter-args</span> #'crm-indicator)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Do not allow the cursor in the minibuffer prompt</span>
  (<span class="org-keyword">setq</span> minibuffer-prompt-properties
        '(read-only t cursor-intangible t face minibuffer-prompt))
  (add-hook 'minibuffer-setup-hook #'cursor-intangible-mode)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Emacs 28: Hide commands in M-x which do not work in the current mode.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Vertico commands are hidden in normal buffers.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq read-extended-command-predicate</span>
  <span class="org-comment-delimiter">;;       </span><span class="org-comment">#'command-completion-default-include-p)</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable recursive minibuffers</span>
  (<span class="org-keyword">setq</span> enable-recursive-minibuffers t))

(use-package marginalia
  <span class="org-builtin">:config</span>
  (marginalia-mode))

(use-package company
  <span class="org-builtin">:config</span>
  (<span class="org-keyword">setq</span> company-global-modes '(not shell-mode))
  (global-company-mode t)
  <span class="org-builtin">:bind</span> (<span class="org-builtin">:map</span> company-active-map (<span class="org-string">"&lt;tab&gt;"</span> . company-complete-selection))
  <span class="org-builtin">:custom</span>
  (company-minimum-prefix-length 1)
  (company-idle-delay 0.0))

(use-package highlight-indentation
  <span class="org-builtin">:straight</span> (highlight-identation <span class="org-builtin">:type</span> git <span class="org-builtin">:host</span> github <span class="org-builtin">:repo</span> <span class="org-string">"antonj/Highlight-Indentation-for-Emacs"</span>)
  <span class="org-builtin">:hook</span> (prog-mode . highlight-indentation-mode)
  <span class="org-builtin">:config</span> (<span class="org-keyword">setq</span> highlight-indentation-blank-lines t))

(use-package rainbow-delimiters
  <span class="org-builtin">:hook</span> (prog-mode . rainbow-delimiters-mode))

(use-package hl-line
  <span class="org-builtin">:config</span> (global-hl-line-mode))

(use-package git-gutter
  <span class="org-builtin">:config</span> (global-git-gutter-mode t))

(use-package helpful)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd8c651b" class="outline-3">
<h3 id="orgd8c651b">Utilities</h3>
<div class="outline-text-3" id="text-orgd8c651b">
<p>
Here are all utilities with no effect on UI.
</p>

<div class="org-src-container">
<pre class="src src-elisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">Utilities</span>

(use-package magit
  <span class="org-builtin">:bind</span> ((<span class="org-string">"C-c s"</span> . magit-status)
         (<span class="org-string">"C-c b"</span> . magit-blame)
         (<span class="org-string">"C-c g"</span> . vc-git-grep)))

(use-package undo-tree
  <span class="org-builtin">:config</span> (global-undo-tree-mode))

(use-package multiple-cursors
  <span class="org-builtin">:bind</span> ((<span class="org-string">"C-c m"</span> . mc/mark-all-in-region)
         (<span class="org-string">"C-c n"</span> . mc/mark-next-like-this)))

(use-package projectile
  <span class="org-builtin">:config</span> (projectile-mode)
  <span class="org-builtin">:bind-keymap</span> (<span class="org-string">"C-c p"</span> . projectile-command-map))

(use-package autorevert)

(use-package which-key
  <span class="org-builtin">:config</span>
  (which-key-mode))

(use-package eldoc)

(use-package realgud
  <span class="org-builtin">:config</span> (load-library <span class="org-string">"realgud"</span>))

(use-package yasnippet
  <span class="org-builtin">:config</span>
  (yas-global-mode t)
  (use-package yasnippet-snippets))

(use-package gazr
  <span class="org-builtin">:straight</span> (gazr <span class="org-builtin">:type</span> git <span class="org-builtin">:host</span> github <span class="org-builtin">:repo</span> <span class="org-string">"volnt/gazr.el"</span>)
  <span class="org-builtin">:bind</span> ((<span class="org-string">"C-c C-g"</span> . gazr)))
</pre>
</div>
</div>

<div id="outline-container-org298c393" class="outline-4">
<h4 id="org298c393">Vterm</h4>
<div class="outline-text-4" id="text-org298c393">
<p>
Emacs-libvterm (vterm) is fully-fledged terminal emulator inside GNU Emacs based on libvterm, a C library. As a result of using compiled code (instead of elisp), emacs-libvterm is fully capable, fast, and it can seamlessly handle large outputs.
</p>

<div class="org-src-container">
<pre class="src src-elisp">
(use-package vterm
  <span class="org-builtin">:config</span>
  (<span class="org-keyword">setq</span> vterm-max-scrollback 100000))

</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgbc6e22c" class="outline-3">
<h3 id="orgbc6e22c">Python setup</h3>
<div class="outline-text-3" id="text-orgbc6e22c">
<p>
Because Python is the language I use the most, I use more packages than just the major-mode.
</p>

<p>
<code>blacken</code> is used for code formatting, and <code>py-isort</code> for imports ordering.
</p>

<p>
<code>lsp-pyright</code> is used for code completion, flycheck warnings and <code>find-definitions</code> / <code>find-references</code>.
</p>

<div class="org-src-container">
<pre class="src src-elisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">Python</span>

(use-package lsp-mode
  <span class="org-builtin">:commands</span> (lsp lsp-deferred)
  <span class="org-builtin">:config</span>
  (lsp-enable-which-key-integration t)
  (use-package lsp-ui)
  (use-package lsp-treemacs))

(use-package py-isort
  <span class="org-builtin">:custom</span> (py-isort-options '(<span class="org-string">"-w 120"</span>))
  <span class="org-builtin">:hook</span> (before-save . py-isort-before-save))

(use-package blacken
  <span class="org-builtin">:hook</span> (python-mode . blacken-mode)
  <span class="org-builtin">:custom</span> (blacken-line-length 120))

(use-package lsp-pyright
  <span class="org-builtin">:hook</span> (python-mode . (<span class="org-keyword">lambda</span> ()
                         (<span class="org-keyword">require</span> '<span class="org-constant">lsp-pyright</span>)
                         (lsp)))  <span class="org-comment-delimiter">; </span><span class="org-comment">or lsp-deferred</span>
  <span class="org-builtin">:init</span> (<span class="org-keyword">setq</span> lsp-pyright-python-executable-cmd <span class="org-string">"python3.8"</span>)
  <span class="org-builtin">:config</span> (<span class="org-keyword">setq</span> lsp-pyright-disable-organize-imports t)
  <span class="org-builtin">:bind-keymap</span> (<span class="org-string">"C-c C-o"</span> . lsp-command-map)
  <span class="org-builtin">:bind</span> ((<span class="org-string">"C-c ;"</span> . xref-find-definitions)
         (<span class="org-string">"C-c ,"</span> . xref-pop-marker-stack)
         (<span class="org-string">"C-c :"</span> . lsp-find-references)))
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 2022-03-28 Mon 13:38</p>
<p class="creator"><a href="https://www.gnu.org/software/emacs/">Emacs</a> 27.1 (<a href="https://orgmode.org">Org</a> mode 9.3)</p>
</div>
</body>
</html>
